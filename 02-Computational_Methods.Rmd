# Computational Methods {#CompMethods}

## Data Collection

All protein-protein interaction data for both _A. Thaliana_ and _S. Cerevisiae_ were downloaded from the STRING database (https://string-db.org/). For each organism, two files were downloaded: protein-info and protein-links. The protein-info files contain the STRING ID of each protein, the proteins common name, the proteins size, and any annotations attached to the protein. The protein-links files contain protein-protein pairs representing individual protein interactions, a number of scoring parameters, and a combined score value which represents the certainty of the interaction. The _A. Thaliana_ dataset consisted of 27,463 proteins and 12,557,495 protein-protein interactions while the _S. Cerevisiae_ dataset contained 6601 proteins and 2,824,843 protein-protein interactions. 

## Thresholding and Pruning

  The STRING database uses a number of distinct evidence souces to calculate the confidence score of each protein protein interaction. Several of these sources use homologous protein interactions as evidence to support the possiblily of identical protein protein interactions occuring in the organism of interest. Due to the nature of this study, interaction evidence obtained through the comparison of homologs must be excluded to prevent the possiblilty of data contamination. Fortunatly, the STRING database provides their edge scoring algorithm as a python script which allowed for evidence channels obtained through homology to be removed and for the combined scores to be re-calculated. The homolog-free edgelist was then thresholded, allowing only PPI's with a combined confidence score greater than 900 to be included in the dataset. This step reduced the _S. Cerevisiae_ edge count to 69,784 and the _A. Thaliana_ edge count to 49,604.
  To further isolate proteins which are likely to implicated in _S. Cerevisiae_ vacuole fusion, a literature review was conducted with the goal of creating a list of core homotypic vacuole fusion proteins. A total of 45 proteins were identified in the literature review. 43 of the 45 proteins names were successfully converted to STRING IDs, however, PBI2 has no recorded PPI's with a confidence score greater than 900. Proteins without recorded PPI's cause errors when integrating the identified proteins of interest into the thresholded network and PBI2 has thus been removed from the core protein list. It is impractical to expect every PPI invovled in homotypic vacuole fusion to be identified through literature review, therfore, a K-hop algorithm was employed to create a subgraph which likely includes the majority of PPIs involved in the fusion process. The K-hop algorithm requires a set of initial nodes (in this case the 42 core proteins) and a k value (k=2 for the _S. Cerevisiae_ dataset) which dictates the number of 'hops' the algorithm performs. This algorithm produces a subgraph which contains the initial nodes and all initial node neighbors that are within k edges from the initial nodes. The _A. Thaliana_ dataset was pruned through a similar mechanism. However, due to the lack of literature focusing on _A. Thaliana_ guard cell homotypic vacuole fusion, a literature review was insufficient for the purpose of idenitfying a set of core proteins. Therefore, a set of _S. Cerevisiae_ homologous proteins was used as the basis for constructing an _A. Thaliana_ core protein set. Using the STRING API's 'homology_best?' method, 37 of the 42 _S. Cerevisiae_ core proteins were matched with homologous proteins from the _A. Thaliana_ dataset. STRING's 'homology_best?' method employs the Smithâ€“Waterman algorithm to perform local sequence alignment and identify likely homologous proteins. This method produces a score which describes the similarity of the two proteins where a higher score denotes a greater similarity between the two proteins. The list of _A. Thaliana_ core homologous proteins was thresholded to include only proteins with SW scores greater than 550 and pruned with the K-hop algorithm using parameters identical to those used in _S. Cerevisiae_ pruning. 

```{r,echo=FALSE,fig.cap="S. Cerevisiae subgraph",out.width="100%"}
knitr::include_graphics("/Users/adenobrien/Desktop/Thesis_Doc/figure/SC_subgraph.png",)
```

```{r,echo=FALSE,fig.cap="A. Thaliana subgraph",out.width="100%"}
knitr::include_graphics("/Users/adenobrien/Desktop/Thesis_Doc/figure/AT_subgraph.png",)
```

## Network Importance Analysis

The steps above resulted in two datasets, one for each organism, each containing three 'layers' consisting of a set of core proteins, the immidiate neighbors of the core proteins, and the neighbors of the immediate neighbors (henceforth referred to as layer 0, layer 1 and layer 2 respectively). All layers were analyzed to determine the degree centrality and clustering coefficient of their constituent nodes. Degree centrality measures the number of edges connecting the node of interest to other nodes within the graph (ie. if a node is connected to 5 neighbors in the graph that node will have a degree centrality of 5). Nodes with higher degree are often thought to be more 'important' to the process modeled by the network and the distribution of node degrees in a network often occurs in a scale free fashion where a small number of nodes have very high degree centrailty while the majority of the nodes have low degree centrality. This is thought to be somewhat of an evolutionary defense mechanism against genetic mutation as loss of function mutations in proteins with low degree centrality are both more likely to happen and are less likely to cause major disruptions in signaling pathways. Clustering coefficinet measures the interconnectedness of nodes in a network. Individual node clustering coefficients are calculated by counting the number of edges between a nodes neighbors and dividing that number by the number of possible connnections between those neighbors. These individual clustering coefficients can be used as a metric for node importance similar to degree or averaged to determine the overal clustering coefficent of the network. Layer 0 of each organism was also analyzed to determine the proportion of homologous edges (ie. edges in which both proteins are homologous and the edge between them appears in both organisms).


## Network Visualization 

Two python packages were used to create visual representations of the _S. Cerevisiae_ and _A. Thaliana_ PPI networks. Cosmograph was used to create two network visualizations for each organism, one which displays a subgraph containing the initial core proteins and their k-neighbors, and one which displays the aforementioned subgraph within the context of the full STRING PPI network. Pymnet was used to construct a multi-layer network visualization in which each of the two layers represents the PPI's between the core proteins of each organism, and edges between the layers represent homologous proteins present in each organim. 

```{r, results='asis', echo=FALSE}
cat("\\newpage")
```

```{r,echo=FALSE,fig.cap="Homologous edges between A. Thaliana and S. Cervisiae",out.width="120%"}
knitr::include_graphics("/Users/adenobrien/Desktop/Thesis_Doc/figure/Multilayer_network.png",)
```